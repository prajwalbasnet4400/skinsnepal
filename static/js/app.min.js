(function(e){function t(t){for(var c,a,o=t[0],i=t[1],u=t[2],d=0,l=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&l.push(r[a][0]),r[a]=0;for(c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c]);m&&m(t);while(l.length)l.shift()();return n.push.apply(n,u||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],c=!0,o=1;o<s.length;o++){var i=s[o];0!==r[i]&&(c=!1)}c&&(n.splice(t--,1),e=a(a.s=s[0]))}return e}var c={},r={app:0},n=[];function a(t){if(c[t])return c[t].exports;var s=c[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=c,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)a.d(s,c,function(t){return e[t]}.bind(null,c));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var m=i;n.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"07ea":function(e,t,s){},"1a0c":function(e,t,s){"use strict";s("b35f")},"36df":function(e,t,s){},"47d7":function(e,t,s){},"4f14":function(e,t,s){"use strict";s("a675")},"56d7":function(e,t,s){"use strict";s.r(t);var c=s("7a23");const r={class:"container"},n={class:"row chat-container m-3 rounded",style:{height:"80vh"}},a={class:"col-4 p-0 d-flex flex-column h-100"},o={class:"col-8 p-0 h-100"};function i(e,t,s,i,u,m){const d=Object(c["l"])("User"),l=Object(c["l"])("Rooms"),b=Object(c["l"])("Chat");return Object(c["h"])(),Object(c["d"])("div",r,[Object(c["e"])("div",n,[Object(c["e"])("div",a,[Object(c["f"])(d,{currentUser:u.currentUser},null,8,["currentUser"]),Object(c["f"])(l,{rooms:u.rooms,activeRoom:u.activeRoom,currentUser:u.currentUser,onMakeActive:m.makeActive},null,8,["rooms","activeRoom","currentUser","onMakeActive"])]),Object(c["e"])("div",o,[Object(c["f"])(b,{rooms:u.rooms,activeRoom:u.activeRoom,messages:u.messages,currentUser:u.currentUser,activeUser:u.activeUser,onSendMessage:m.sendMessage,onGet_messages:m.getMessages},null,8,["rooms","activeRoom","messages","currentUser","activeUser","onSendMessage","onGet_messages"])])])])}const u=e=>(Object(c["j"])("data-v-5738c03e"),e=e(),Object(c["i"])(),e),m={key:0,class:"chat d-flex flex-column"},d={class:"chat-header chat-container-light p-2 mb-auto"},l=["src"],b={class:"ms-3"},h={class:"chat-input mt-auto d-flex"},v=u(()=>Object(c["e"])("i",{class:"fa-solid fa-paper-plane-top"},"Send",-1)),f=[v],O={key:1},p=u(()=>Object(c["e"])("div",{class:"w-100 h-100 text-center"},[Object(c["e"])("p",null,"All empty")],-1)),j=[p];function g(e,t,s,r,n,a){const o=Object(c["l"])("Message");return s.activeRoom?(Object(c["h"])(),Object(c["d"])("div",m,[Object(c["e"])("div",d,[Object(c["e"])("img",{src:s.activeUser.avatar,alt:"avatar",class:"avatar"},null,8,l),Object(c["e"])("span",b,Object(c["m"])(s.activeUser.username),1)]),Object(c["e"])("div",{class:"chat-body px-2",id:"chat-body",onScroll:t[0]||(t[0]=(...e)=>a.handleScroll&&a.handleScroll(...e))},[(Object(c["h"])(!0),Object(c["d"])(c["a"],null,Object(c["k"])(s.messages,e=>(Object(c["h"])(),Object(c["d"])("div",{key:e.room},[Object(c["f"])(o,{message:e,currentUser:s.currentUser},null,8,["message","currentUser"])]))),128))],32),Object(c["e"])("div",h,[Object(c["o"])(Object(c["e"])("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>n.chatInput=e),class:"p-2 m-1",onKeydown:t[2]||(t[2]=Object(c["p"])((...e)=>a.sendMessage&&a.sendMessage(...e),["enter"]))},null,544),[[c["n"],n.chatInput]]),Object(c["e"])("button",{class:"btn btn-sm text-white",onClick:t[3]||(t[3]=(...e)=>a.sendMessage&&a.sendMessage(...e))},f)])])):(Object(c["h"])(),Object(c["d"])("div",O,j))}const U={class:"d-flex"},k={class:"message-content"};function y(e,t,s,r,n,a){return Object(c["h"])(),Object(c["d"])("div",U,[Object(c["e"])("div",{class:Object(c["g"])([{ownuser:a.ownUser()},"message"])},[Object(c["e"])("span",k,Object(c["m"])(s.message.content),1)],2)])}var _={name:"Message",props:{message:Object,currentUser:Object},methods:{ownUser:function(){return this.currentUser.steamid64==this.message.steamid64}}},R=(s("4f14"),s("6b0d")),w=s.n(R);const M=w()(_,[["render",y],["__scopeId","data-v-29e4b29d"]]);var S=M,A={name:"Chat",components:{Message:S},props:{activeRoom:Number,activeUser:Object,rooms:Array,messages:Array,currentUser:Object,scrollData:Number},mounted(){this.get_room()},data(){return{chatInput:"",room:void 0}},methods:{handleScroll:function(e){0==e.target.scrollTop&&this.$emit("get_messages")},sendMessage:function(){this.$emit("sendMessage",this.chatInput),this.chatInput=""},get_room:function(){var e=this.activeRoom;for(let t of this.rooms)if(t.id==e)for(let e of t.user)if(e.steamid64!=this.currentUser.steamid64)return e}}};s("e147");const x=w()(A,[["render",g],["__scopeId","data-v-5738c03e"]]);var I=x;const C={class:"chat-container-light rooms ms-2"};function P(e,t,s,r,n,a){const o=Object(c["l"])("Room");return Object(c["h"])(),Object(c["d"])("div",C,[(Object(c["h"])(!0),Object(c["d"])(c["a"],null,Object(c["k"])(s.rooms,e=>(Object(c["h"])(),Object(c["d"])("div",{key:e.id},[Object(c["f"])(o,{room:e,activeRoom:s.activeRoom,onMakeActive:a.makeActive,currentUser:s.currentUser},null,8,["room","activeRoom","onMakeActive","currentUser"])]))),128))])}const N=["src"],T={class:"ms-3"};function J(e,t,s,r,n,a){return Object(c["h"])(),Object(c["d"])("div",null,[(Object(c["h"])(!0),Object(c["d"])(c["a"],null,Object(c["k"])(s.room.user,e=>(Object(c["h"])(),Object(c["d"])("div",{key:e.id},[a.isCurrentUser(e.steamid64)?Object(c["c"])("",!0):(Object(c["h"])(),Object(c["d"])("div",{key:0,onClick:t[0]||(t[0]=(...e)=>a.makeActive&&a.makeActive(...e))},[Object(c["e"])("div",{class:Object(c["g"])([{active:a.isActiveRoom()},"p-2 m-1 rounded room"])},[Object(c["e"])("div",null,[Object(c["e"])("img",{src:e.avatar,alt:"avatar",class:"avatar"},null,8,N),Object(c["e"])("span",T,Object(c["m"])(e.username),1)])],2)]))]))),128))])}var $={name:"Room",props:{room:Object,activeRoom:Number,currentUser:Object},methods:{isCurrentUser:function(e){return e==this.currentUser.steamid64},isActiveRoom:function(){return this.room.id==this.activeRoom},makeActive:function(){this.$emit("makeActive",this.room.id)}}};s("65bc");const D=w()($,[["render",J],["__scopeId","data-v-5c30b0be"]]);var B=D,E={name:"Rooms",components:{Room:B},props:{rooms:Array,activeRoom:Number,currentUser:Object},methods:{makeActive:function(e){this.$emit("makeActive",e)}}};s("1a0c");const G=w()(E,[["render",P],["__scopeId","data-v-4f2a1c36"]]);var H=G;const K={class:"w-100 chat-container-light"},V={class:"p-2"},W=["src"],q={class:"s-0"};function z(e,t,s,r,n,a){return Object(c["h"])(),Object(c["d"])("div",K,[Object(c["e"])("div",V,[Object(c["e"])("img",{src:s.currentUser.avatar,class:"avatar",alt:"avatar"},null,8,W),Object(c["e"])("span",q,Object(c["m"])(s.currentUser.username),1)])])}var F={name:"User",props:{currentUser:Object}};s("9b0d");const L=w()(F,[["render",z],["__scopeId","data-v-4a10ce77"]]);var Q=L,X={name:"App",components:{Rooms:H,Chat:I,User:Q},methods:{filterUser:function(e){for(let t of e)if(t.steamid64!=this.currentUser.steamid64)return t},makeActive:function(e){if(this.activeRoom==e)return 0;this.activeRoom=e;for(let t of this.rooms)if(t.id==e)for(let e of t.user)if(e.steamid64!=this.currentUser.steamid64)return this.activeUser=e,this.createChat(),0},getMessages:function(){var e={command:"get_messages",to_user:this.activeUser.steamid64};0!=this.messages.length&&(e.from_range=this.messages[0].date_sent),this.sendSocket(e)},sendMessage:function(e){var t={command:"send_message",to_user:this.activeUser.steamid64,message:e};this.sendSocket(t)},sendSocket:function(e){this.socket.send(JSON.stringify(e))},getUser:function(){var e={command:"get_user"};this.sendSocket(e)},getRooms:function(){var e={command:"get_chat"};this.sendSocket(e)},createChat:function(){var e={command:"create_chat",to_user:this.activeUser.steamid64};this.sendSocket(e)},handleData:function(e){switch(e.command){case"get_user":this.currentUser=e.data;break;case"get_chat":this.rooms=e.data;break;case"create_chat":this.getMessages();break;case"send_message":this.messages.push(e);var t=document.getElementById("chat-body");t.scrollTop=t.scrollHeight;break;case"get_messages":if(0!=this.messages.length){t=document.getElementById("chat-body");t.scrollTop=t.scrollTop+10,this.messages=[...e.data,...this.messages]}else this.messages=e.data;break}}},data(){return{rooms:[],activeRoom:0,activeUser:{steamid64:"",username:"",avatar:""},messages:[],currentUser:{steamid64:"",username:"",avatar:""},socket:null}},created:function(){let e=this;this.socket=new ReconnectingWebSocket("ws://"+window.location.host+"/ws/api/"),this.socket.onopen=function(t){e.getRooms(),e.getUser(),e.activeRoom&&e.createChat()},this.socket.onmessage=function(t){e.handleData(JSON.parse(t.data))}}};s("b775");const Y=w()(X,[["render",i]]);var Z=Y;Object(c["b"])(Z).mount("#app")},"65bc":function(e,t,s){"use strict";s("36df")},"86c3":function(e,t,s){},"9b0d":function(e,t,s){"use strict";s("07ea")},a675:function(e,t,s){},b35f:function(e,t,s){},b775:function(e,t,s){"use strict";s("47d7")},e147:function(e,t,s){"use strict";s("86c3")}});
//# sourceMappingURL=app.min.js.map